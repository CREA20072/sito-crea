<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CREA 20072 - Associazione Culturale Pieve Emanuele</title>
    <meta name="description" content="Associazione di genitori e cittadini attivi. Organizziamo eventi, cultura e momenti di comunit√† a Pieve Emanuele.">
    <meta property="og:title" content="CREA 20072 - Pieve Emanuele">
    <meta property="og:description" content="Organizziamo eventi, cultura e momenti di comunit√†.">
    <meta property="og:image" content="logo.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --honey:#E3A500; --honey-dark:#C28D00; --soft-bg:#F7F7F7; }
        body { font-family:'Montserrat',sans-serif; scroll-behavior:smooth; color:#1F2933; background:#FFF; }
        .headline-strong { font-weight:800; letter-spacing:-0.025em; line-height:1.15; }
        .text-body-crea  { font-weight:400; line-height:1.8; color:#555; }
        .text-crea-honey { color:var(--honey); }
        .bg-crea-honey   { background-color:var(--honey); }
        .bg-crea-soft    { background-color:var(--soft-bg); }
        .fade-up { opacity:0; transform:translateY(30px); transition:opacity .8s ease,transform .8s ease; }
        .fade-up.visible { opacity:1; transform:translateY(0); }
        .cta-button {
            background-color:var(--honey); color:white; border-radius:999px;
            padding:1rem 2.5rem; font-weight:700;
            transition:transform .3s,background-color .3s,box-shadow .3s;
            display:inline-flex; align-items:center; justify-content:center; gap:.5rem;
            text-transform:uppercase; letter-spacing:.05em; border:none; cursor:pointer;
        }
        .cta-button:hover { transform:translateY(-4px); background-color:var(--honey-dark); box-shadow:0 10px 25px rgba(227,165,0,.35); }
        /*
         * DIMENSIONI CONSIGLIATE IMMAGINI
         * Locandina evento in evidenza  ‚Üí 600√ó900px  (verticale 2:3) ‚Äî i flyer Instagram vanno benissimo
         * Card archivio                 ‚Üí 800√ó600px  (orizzontale 4:3) oppure 800√ó800 quadrata
         * Foto galleria nella modale    ‚Üí min 800px lato lungo, qualsiasi formato
         */
        .img-cover   { width:100%; height:100%; object-fit:cover;   object-position:center; }
        .img-contain { width:100%; height:100%; object-fit:contain; background-color:#f3f4f6; }
        .archive-card {
            position:relative; overflow:hidden; border-radius:20px;
            background:white; border:1px solid #f0f0f0;
            transition:transform .3s,box-shadow .3s; cursor:pointer;
        }
        .archive-card:hover { transform:translateY(-6px); box-shadow:0 20px 40px rgba(0,0,0,.12); }
        .filter-btn {
            padding:.6rem 1.4rem; border-radius:999px; border:1px solid #eee;
            color:#6B7280; font-size:.75rem; text-transform:uppercase; font-weight:600;
            transition:background-color .3s,color .3s,border-color .3s; cursor:pointer; background:white;
        }
        .filter-btn.active             { background-color:var(--honey); color:white; border-color:var(--honey); }
        .filter-btn:hover:not(.active) { border-color:var(--honey); color:var(--honey); }
        .decalogo-card {
            background:white; border-radius:20px; border:1px solid #f0f0f0; padding:2.2rem;
            transition:background-color .4s,transform .4s,border-color .4s,box-shadow .4s;
            display:flex; flex-direction:column; gap:1rem;
        }
        .decalogo-card:hover { background-color:#FFF8E6; transform:translateY(-5px); border-color:var(--honey); box-shadow:0 15px 40px rgba(0,0,0,.05); }
        /* Centra l'ultimo elemento del decalogo se √® solo nella sua riga */
        @media(min-width:1024px){
            #decalogo-grid > .decalogo-card:last-child:nth-child(3n+1) { grid-column: 2; }
        }
        @media(min-width:768px) and (max-width:1023px){
            #decalogo-grid > .decalogo-card:last-child:nth-child(2n+1) { grid-column: 1 / -1; max-width: 50%; margin: 0 auto; }
        }
        #mobile-menu { transform:translateX(100%); transition:transform .3s ease; }
        #mobile-menu.active { transform:translateX(0); }
        .section-padding { padding-top:80px; padding-bottom:80px; }
        @media(min-width:1024px){ .section-padding { padding-top:120px; padding-bottom:120px; } }
        .logo-img { height:45px; width:auto; object-fit:contain; }
        .date-badge {
            position:absolute; top:1.5rem; left:1.5rem;
            background-color:var(--honey); color:white;
            padding:.8rem .6rem; border-radius:12px; z-index:10;
            min-width:70px; text-align:center; box-shadow:0 8px 16px rgba(0,0,0,.2);
            display:flex; flex-direction:column; align-items:center;
        }
        .form-input {
            background-color:rgba(255,255,255,.1); border:1px solid rgba(255,255,255,.2);
            color:white; border-radius:12px; padding:1rem; width:100%;
            transition:border-color .3s,background-color .3s; font-family:'Montserrat',sans-serif;
        }
        .form-input::placeholder { color:rgba(255,255,255,.4); }
        .form-input:focus { outline:none; border-color:var(--honey); background-color:rgba(255,255,255,.15); }

        /* MODALE */
        #modal-overlay { opacity:0; pointer-events:none; transition:opacity .35s ease; }
        #modal-overlay.open { opacity:1; pointer-events:auto; }
        #modal-content {
            transform:translateY(24px) scale(.98); opacity:0;
            transition:transform .35s cubic-bezier(.34,1.56,.64,1),opacity .35s ease;
            max-height:92vh;
        }
        #modal-overlay.open #modal-content { transform:translateY(0) scale(1); opacity:1; }
        /* Immagine copertina modale: proporzioni originali preservate */
        .modal-hero { position:relative; background:#111; overflow:hidden; }
        .modal-hero img { width:100%; height:auto; max-height:70vh; object-fit:contain; display:block; }
        .modal-hero-gradient {
            position:absolute; inset:0;
            background:linear-gradient(to top,rgba(0,0,0,.85) 0%,rgba(0,0,0,.1) 55%,transparent 100%);
            pointer-events:none;
        }
        .modal-hero-text { position:absolute; bottom:0; left:0; right:0; padding:2rem 2.5rem; }

        /* Galleria modale ‚Äî miniature piccole */
        .modal-gallery { display:flex; flex-wrap:wrap; gap:.5rem; }
        .modal-gallery-item { width:90px; height:90px; flex-shrink:0; overflow:hidden; border-radius:10px; cursor:pointer; background:#f3f4f6; }
        .modal-gallery-item img { width:100%; height:100%; object-fit:cover; transition:transform .4s,opacity .3s; }
        .modal-gallery-item:hover img { transform:scale(1.08); opacity:.9; }

        /* Lightbox */
        #lightbox {
            position:fixed; inset:0; z-index:300; background:rgba(0,0,0,.95);
            display:flex; align-items:center; justify-content:center;
            opacity:0; pointer-events:none; transition:opacity .25s ease;
        }
        #lightbox.open { opacity:1; pointer-events:auto; }
        #lightbox img { max-width:92vw; max-height:88vh; object-fit:contain; border-radius:8px; }
        #lightbox-close {
            position:absolute; top:1.25rem; right:1.25rem;
            background:rgba(255,255,255,.15); border:none; color:white;
            width:2.5rem; height:2.5rem; border-radius:50%; cursor:pointer;
            display:flex; align-items:center; justify-content:center; transition:background .2s;
        }
        #lightbox-close:hover { background:rgba(255,255,255,.3); }
    </style>
</head>
<body class="overflow-x-hidden">

    <!-- NAVIGAZIONE -->
    <nav id="main-nav" class="fixed w-full z-[90] bg-white/95 backdrop-blur-md border-b border-gray-100 transition-shadow duration-300">
        <div class="container mx-auto px-5 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3 cursor-pointer" onclick="window.scrollTo({top:0,behavior:'smooth'})">
                <div id="nav-logo-container"><img src="logo.png" alt="Logo CREA 20072" class="logo-img" onerror="this.outerHTML='<span style=\'font-size:2rem\'>üêù</span>'"></div>
                <span class="text-xl md:text-2xl font-bold tracking-tighter uppercase headline-strong">CREA 20072</span>
            </div>
            <div class="hidden lg:flex space-x-10 font-bold text-[11px] uppercase tracking-[0.2em] text-gray-500">
                <a href="#chi-siamo" class="hover:text-crea-honey transition-colors">Chi Siamo</a>
                <a href="#decalogo"  class="hover:text-crea-honey transition-colors">Decalogo</a>
                <a href="#eventi"    class="hover:text-crea-honey transition-colors">Eventi</a>
                <a href="#contatti"  class="hover:text-crea-honey transition-colors">Contatti</a>
            </div>
            <button onclick="toggleMenu(true)" class="lg:hidden p-2 text-crea-honey" aria-label="Apri menu"><i data-lucide="menu"></i></button>
        </div>
    </nav>

    <!-- MENU MOBILE -->
    <div id="mobile-menu" class="fixed inset-0 z-[110] bg-white flex flex-col p-10 lg:hidden text-center justify-center space-y-8">
        <button onclick="toggleMenu(false)" class="absolute top-6 right-6 p-2 text-gray-400" aria-label="Chiudi menu"><i data-lucide="x" class="w-8 h-8"></i></button>
        <a href="#chi-siamo" onclick="toggleMenu(false)" class="text-2xl font-bold uppercase tracking-widest text-gray-800 hover:text-crea-honey transition-colors">Chi Siamo</a>
        <a href="#decalogo"  onclick="toggleMenu(false)" class="text-2xl font-bold uppercase tracking-widest text-gray-800 hover:text-crea-honey transition-colors">Decalogo</a>
        <a href="#eventi"    onclick="toggleMenu(false)" class="text-2xl font-bold uppercase tracking-widest text-gray-800 hover:text-crea-honey transition-colors">Eventi</a>
        <a href="#contatti"  onclick="toggleMenu(false)" class="text-2xl font-bold uppercase tracking-widest text-gray-800 hover:text-crea-honey transition-colors">Contatti</a>
    </div>

    <!-- MODALE EVENTO -->
    <div id="modal-overlay" class="fixed inset-0 z-[200] bg-black/75 flex items-center justify-center p-4 backdrop-blur-sm" onclick="closeModal()">
        <div id="modal-content" class="bg-white rounded-[1.75rem] w-full max-w-3xl overflow-y-auto relative" onclick="event.stopPropagation()">
            <button onclick="closeModal()" aria-label="Chiudi" class="absolute top-4 right-4 z-20 bg-black/40 hover:bg-black/60 text-white p-2 rounded-full transition-colors backdrop-blur-sm"><i data-lucide="x" class="w-4 h-4"></i></button>
            <div id="modal-body"></div>
        </div>
    </div>

    <!-- LIGHTBOX -->
    <div id="lightbox" onclick="closeLightbox()">
        <button id="lightbox-close" onclick="closeLightbox()" aria-label="Chiudi foto"><i data-lucide="x" class="w-4 h-4"></i></button>
        <img id="lightbox-img" src="" alt="Foto evento">
    </div>

    <!-- HERO -->
    <section id="hero-section" class="relative h-[85vh] md:h-[90vh] flex items-center justify-center text-center text-white bg-black">
        <div id="hero-bg" class="absolute inset-0 bg-cover bg-center"></div>
        <div class="absolute inset-0 bg-gradient-to-b from-black/70 via-black/60 to-black/80"></div>
        <div class="relative z-10 px-6 w-full max-w-6xl mx-auto">
            <h1 id="hero-title" class="fade-up text-3xl sm:text-5xl md:text-7xl headline-strong mb-6 uppercase leading-tight"></h1>
            <p  id="hero-subtitle" class="fade-up text-base md:text-xl font-light mb-12 max-w-2xl mx-auto leading-relaxed text-white/90"></p>
            <div class="fade-up"><a href="#eventi" id="hero-cta" class="cta-button w-full sm:w-auto"></a></div>
        </div>
    </section>

    <!-- CHI SIAMO -->
    <section id="chi-siamo" class="section-padding bg-white text-center">
        <div class="container mx-auto px-6">
            <div class="max-w-4xl mx-auto mb-20">
                <h2 id="about-title" class="text-3xl md:text-5xl font-bold uppercase tracking-tight headline-strong text-black"></h2>
                <div class="h-1 w-20 bg-crea-honey mx-auto mt-6 rounded-full"></div>
                <p  id="about-text" class="mt-8 text-lg md:text-xl font-light text-body-crea opacity-90"></p>
            </div>
            <div id="values-grid" class="grid grid-cols-1 md:grid-cols-3 gap-12 max-w-6xl mx-auto mb-16 text-center"></div>
            <p   id="about-tagline" class="text-xs uppercase tracking-[0.3em] text-gray-400 font-bold"></p>
        </div>
    </section>

    <!-- DECALOGO -->
    <section id="decalogo" class="section-padding bg-crea-soft border-y border-gray-100 text-center">
        <div class="container mx-auto px-6">
            <div class="mb-20">
                <h2 class="text-3xl md:text-4xl font-bold mb-4 uppercase tracking-tight headline-strong text-black">Il Decalogo di CREA 20072</h2>
                <p class="text-gray-500 font-bold text-xs tracking-widest uppercase">I valori che ci guidano ogni giorno</p>
            </div>
            <div id="decalogo-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-7xl mx-auto text-left"></div>
        </div>
    </section>

    <!-- EVENTI -->
    <section id="eventi" class="section-padding bg-white">
        <div class="container mx-auto px-5 md:px-6">
            <div class="mb-32 text-center">
                <div class="mb-16">
                    <span class="text-crea-honey bg-yellow-50 px-4 py-2 rounded-full text-xs font-bold uppercase tracking-widest inline-block mb-4">Prossimo Appuntamento</span>
                    <h2 class="text-3xl md:text-5xl font-bold uppercase tracking-tight headline-strong text-black">Cosa stiamo preparando</h2>
                </div>
                <div id="featured-event-slot" class="max-w-6xl mx-auto text-left"></div>
            </div>
            <div class="pt-24 border-t border-gray-100 text-center">
                <h2 class="text-3xl font-bold uppercase tracking-tight headline-strong mb-4 text-black">I momenti di comunit√†</h2>
                <p class="text-gray-400 text-xs uppercase tracking-widest font-bold mb-12">La nostra storia, un evento alla volta</p>
                <div id="filter-bar" class="flex flex-wrap justify-center gap-3 mb-16"></div>
                <div id="archive-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 text-left"></div>
                <div class="mt-24 text-center px-4">
                    <p id="strategic-quote" class="text-lg md:text-2xl font-light max-w-3xl mx-auto italic text-gray-400"></p>
                </div>
            </div>
        </div>
    </section>

    <!-- FOOTER -->
    <footer id="contatti" class="bg-black text-white py-20 px-6">
        <div class="container mx-auto max-w-7xl">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 lg:gap-24">
                <div class="flex flex-col justify-between">
                    <div>
                        <div class="flex items-center gap-4 mb-8">
                            <div id="footer-logo-container"><img src="logo.png" alt="Logo" class="logo-img" onerror="this.outerHTML='<span style=\'font-size:2rem\'>üêù</span>'"></div>
                            <span class="text-2xl font-bold tracking-tighter uppercase headline-strong">CREA 20072</span>
                        </div>
                        <div id="contact-methods" class="flex flex-col gap-4 text-sm text-gray-400 font-medium"></div>
                        <div id="social-links" class="flex gap-6 mt-8"></div>
                    </div>
                    <div class="hidden lg:block text-xs text-gray-500 uppercase tracking-widest mt-12">&copy; 2026 CREA 20072 ‚Äì Progetto Indipendente ‚Äì Pieve Emanuele (MI)</div>
                </div>
                <div class="bg-white/5 p-8 md:p-10 rounded-3xl border border-white/10">
                    <h3 class="text-2xl font-bold mb-2 headline-strong">Scrivici un messaggio</h3>
                    <p class="text-gray-400 text-sm mb-6">Ti risponderemo il prima possibile.</p>
                    <form id="contact-form" class="space-y-4" onsubmit="handleFormSubmit(event)">
                        <div><label class="block text-xs uppercase tracking-widest text-gray-500 mb-2" for="nome">Nome</label><input type="text" id="nome" name="nome" required class="form-input" placeholder="Il tuo nome"></div>
                        <div><label class="block text-xs uppercase tracking-widest text-gray-500 mb-2" for="email">Email</label><input type="email" id="email" name="email" required class="form-input" placeholder="tua@email.com"></div>
                        <div><label class="block text-xs uppercase tracking-widest text-gray-500 mb-2" for="messaggio">Messaggio</label><textarea id="messaggio" name="messaggio" required rows="4" class="form-input" placeholder="Cosa vuoi dirci?"></textarea></div>
                        <button type="submit" class="cta-button w-full mt-4">Invia Messaggio</button>
                        <p id="form-feedback" class="text-center text-sm mt-3 hidden"></p>
                    </form>
                </div>
                <div class="lg:hidden text-center text-xs text-gray-500 uppercase tracking-widest mt-4">&copy; 2026 CREA 20072 ‚Äì Pieve Emanuele (MI)</div>
            </div>
        </div>
    </footer>

    <script>
        const SOCIAL_ICONS = {
            facebook:  '<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/></svg>',
            instagram: '<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"/></svg>',
            whatsapp:  '<svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>'
        };

        function toggleMenu(open) {
            document.getElementById('mobile-menu').classList.toggle('active', open);
            document.body.style.overflow = open ? 'hidden' : 'auto';
        }

        function openLightbox(src) {
            document.getElementById('lightbox-img').src = src;
            document.getElementById('lightbox').classList.add('open');
        }
        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('open');
        }

        function openModal(id) {
            const item = window._ARCHIVE.find(e => e.id === id);
            if (!item) return;

            const pics    = item.gallery || [];
            const colsMap = {1:'cols-1', 2:'cols-2', 3:'cols-3'};
            const colsCls = colsMap[pics.length] || 'cols-4';

            const galleryHtml = pics.length ? `
                <div class="mt-8 pt-6 border-t border-gray-100">
                    <p class="text-[10px] font-bold uppercase tracking-widest text-gray-400 mb-4">Galleria</p>
                    <div class="modal-gallery ${colsCls}">
                        ${pics.map(src => `
                            <div class="modal-gallery-item" onclick="openLightbox('${src}')">
                                <img src="${src}" alt="Foto ${item.t}" loading="lazy">
                            </div>`).join('')}
                    </div>
                </div>` : '';

            const tagColors = { famiglie:'bg-blue-100 text-blue-800', tradizioni:'bg-orange-100 text-orange-800', spettacoli:'bg-purple-100 text-purple-800' };
            const tagCls    = tagColors[item.tag] || 'bg-gray-100 text-gray-700';

            document.getElementById('modal-body').innerHTML = `
                <div class="modal-hero rounded-t-[1.75rem]">
                    <img src="${item.img}" alt="Locandina ${item.t}">
                    <div class="modal-hero-gradient"></div>
                    <div class="modal-hero-text">
                        <span class="${tagCls} px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wider inline-block mb-3">${item.tag}</span>
                        <h2 class="text-white text-2xl md:text-4xl font-extrabold uppercase leading-tight tracking-tight">${item.t}</h2>
                        <p class="text-white/70 text-sm mt-1 font-medium uppercase tracking-wider">${item.d}</p>
                    </div>
                </div>
                <div style="padding:2rem 2.5rem 2.5rem">
                    <div class="inline-flex items-center gap-2 bg-yellow-50 border border-yellow-200 text-yellow-800 text-xs font-bold uppercase tracking-widest px-4 py-2 rounded-full mb-6">
                        <i data-lucide="users" class="w-3.5 h-3.5"></i> ${item.n}
                    </div>
                    <p class="text-gray-600 text-base leading-relaxed">${item.fullDesc || item.desc}</p>
                    ${galleryHtml}
                </div>`;

            setTimeout(() => document.getElementById('modal-overlay').classList.add('open'), 10);
            document.body.style.overflow = 'hidden';
            lucide.createIcons();
        }

        function closeModal() {
            document.getElementById('modal-overlay').classList.remove('open');
            setTimeout(() => { document.body.style.overflow = 'auto'; }, 350);
        }

        document.addEventListener('keydown', e => {
            if (e.key === 'Escape') {
                if (document.getElementById('lightbox').classList.contains('open')) closeLightbox();
                else closeModal();
            }
        });

        function renderArchive(tag) {
            const grid = document.getElementById('archive-grid');
            grid.innerHTML = '';
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.toggle('active', b.id === `btn-${tag}`));

            const items = window._ARCHIVE
                .filter(item => tag === 'all' || item.tag === tag)
                .sort((a, b) => new Date(b.date) - new Date(a.date));

            if (!items.length) {
                grid.innerHTML = '<p class="col-span-3 text-gray-400 text-center py-12">Nessun evento in questa categoria.</p>';
                return;
            }
            items.forEach(item => {
                grid.innerHTML += `
                    <div class="archive-card group" onclick="openModal(${item.id})"
                         role="button" tabindex="0" aria-label="Apri scheda ${item.t}"
                         onkeydown="if(event.key==='Enter')openModal(${item.id})">
                        <div class="h-56 overflow-hidden bg-gray-100">
                            <img src="${item.img}" loading="lazy" class="img-cover transition-transform duration-500 group-hover:scale-105" alt="Locandina ${item.t}">
                        </div>
                        <div class="absolute top-4 right-4 bg-white/95 backdrop-blur px-3 py-1 rounded-full text-[10px] font-bold uppercase text-black tracking-wider shadow-sm">${item.tag}</div>
                        <div class="p-7">
                            <p class="text-xs font-bold text-crea-honey uppercase tracking-widest mb-2">${item.d}</p>
                            <h3 class="text-xl font-bold mb-1 uppercase headline-strong text-black">${item.t}</h3>
                            <p class="text-sm text-gray-500 mt-2 line-clamp-2">${item.desc}</p>
                            <div class="flex justify-between items-center mt-6 pt-4 border-t border-gray-100">
                                <span class="text-xs font-semibold text-gray-400 uppercase tracking-wider">${item.n}</span>
                                <span class="text-xs font-bold uppercase tracking-tighter text-gray-800 group-hover:text-crea-honey transition-colors">Scopri ‚Üí</span>
                            </div>
                        </div>
                    </div>`;
            });
        }

        async function handleFormSubmit(event) {
            event.preventDefault();
            const form=event.target, feedback=document.getElementById('form-feedback'), btn=form.querySelector('button[type="submit"]');
            const url=window._DATA?.settings?.formspreeUrl;
            btn.disabled=true; btn.textContent='Invio in corso...';
            if (url && url.startsWith('https://formspree.io')) {
                try {
                    const res=await fetch(url,{method:'POST',body:new FormData(form),headers:{'Accept':'application/json'}});
                    if(res.ok){ feedback.textContent='‚úÖ Messaggio inviato! Ti risponderemo presto.'; feedback.className='text-center text-sm mt-3 text-green-400'; form.reset(); }
                    else throw new Error();
                } catch { feedback.textContent='‚ùå Errore. Scrivici a '+(window._DATA?.footer?.email||'accrea20072@gmail.com'); feedback.className='text-center text-sm mt-3 text-red-400'; }
            } else {
                const dest=window._DATA?.footer?.email||'accrea20072@gmail.com';
                window.location.href=`mailto:${dest}?subject=Messaggio da ${encodeURIComponent(document.getElementById('nome').value)}&body=${encodeURIComponent(document.getElementById('messaggio').value)}%0A%0AEmail: ${encodeURIComponent(document.getElementById('email').value)}`;
            }
            feedback.classList.remove('hidden'); btn.disabled=false; btn.textContent='Invia Messaggio';
        }

        /* INIZIALIZZAZIONE */
        fetch('data/content.json')
            .then(r => { if(!r.ok) throw new Error(); return r.json(); })
            .then(D => {
                window._DATA    = D;
                window._ARCHIVE = D.archive;

                window.addEventListener('scroll', () => { document.getElementById('main-nav').classList.toggle('shadow-lg', window.scrollY > 30); });
                setTimeout(() => document.querySelectorAll('.fade-up').forEach(el => el.classList.add('visible')), 150);

                // HERO
                // "LO ORGANIZZIAMO." colorato in giallo miele, sempre sulla stessa riga
                const heroText = D.hero.title;
                const keyword  = 'Lo organizziamo.';
                document.getElementById('hero-title').innerHTML = heroText.includes(keyword)
                    ? heroText.replace(keyword, `<span class="text-crea-honey whitespace-nowrap">${keyword}</span>`)
                    : heroText;
                document.getElementById('hero-subtitle').innerText = D.hero.subtitle;
                document.getElementById('hero-cta').innerText      = D.hero.cta;
                document.getElementById('hero-bg').style.backgroundImage = `url('${D.hero.bg}')`;

                // CHI SIAMO
                document.getElementById('about-title').innerText   = D.about.title;
                document.getElementById('about-text').innerHTML    = D.about.text;
                document.getElementById('about-tagline').innerText = D.about.tagline;
                const vg = document.getElementById('values-grid');
                D.about.pillars.forEach(p => { vg.innerHTML += `<div class="flex flex-col items-center"><div class="w-20 h-20 bg-crea-soft rounded-3xl flex items-center justify-center mb-6 text-crea-honey"><i data-lucide="${p.icon}" class="w-10 h-10"></i></div><h3 class="text-xl font-bold mb-3 headline-strong text-black uppercase">${p.t}</h3><p class="text-sm text-gray-500 max-w-[200px] text-body-crea">${p.d}</p></div>`; });

                // DECALOGO
                const dg = document.getElementById('decalogo-grid');
                D.decalogo.items.forEach(v => { dg.innerHTML += `<div class="decalogo-card"><div class="font-bold tracking-widest text-crea-honey text-xs">${v.n}</div><div class="text-gray-800"><i data-lucide="${v.i}" class="w-8 h-8"></i></div><div><h3 class="font-bold text-lg mb-2 uppercase headline-strong text-black">${v.t}</h3><p class="text-sm leading-relaxed text-gray-600">${v.d}</p></div></div>`; });

                // EVENTO IN EVIDENZA
                const ev = D.featuredEvent;
                document.getElementById('featured-event-slot').innerHTML = `
                    <div class="bg-white rounded-[2.5rem] border border-gray-100 shadow-xl overflow-hidden flex flex-col lg:flex-row">
                        <div class="relative lg:w-5/12 h-96 lg:h-auto bg-gray-100">
                            <div class="date-badge"><span class="text-3xl font-extrabold leading-none">${ev.day}</span><span class="text-xs font-bold tracking-widest mt-1 block">${ev.month}</span></div>
                            <img src="${ev.img||'https://images.unsplash.com/photo-1502602898657-3e91760cbb34?q=80&w=800'}" class="img-contain w-full h-full" alt="Locandina ${ev.title}">
                        </div>
                        <div class="p-8 lg:p-16 lg:w-7/12 flex flex-col justify-center text-left">
                            <h3 class="text-4xl md:text-6xl headline-strong mb-4 uppercase text-black leading-tight">${ev.title}</h3>
                            <h4 class="text-xl font-bold text-gray-400 mb-8 uppercase tracking-tight">${ev.sub}</h4>
                            <p class="text-lg text-body-crea mb-12 font-light">${ev.desc}</p>
                            <div class="space-y-6 mb-12 border-t border-b border-gray-100 py-10">
                                <div class="flex items-center gap-4"><i data-lucide="calendar" class="text-crea-honey w-6 h-6 flex-shrink-0"></i><div><span class="text-xs font-bold text-gray-400 uppercase tracking-widest block mb-1">Quando</span><span class="font-bold text-sm uppercase">${ev.fullDate}</span></div></div>
                                <div class="flex items-center gap-4"><i data-lucide="map-pin" class="text-crea-honey w-6 h-6 flex-shrink-0"></i><div><span class="text-xs font-bold text-gray-400 uppercase tracking-widest block mb-1">Luogo</span><span class="font-bold text-sm uppercase">${ev.place}</span></div></div>
                                <div class="flex items-center gap-4"><i data-lucide="ticket" class="text-crea-honey w-6 h-6 flex-shrink-0"></i><div><span class="text-xs font-bold text-gray-400 uppercase tracking-widest block mb-1">Contributo</span><span class="font-bold text-sm uppercase">${ev.prices}</span></div></div>
                            </div>
                            <div class="flex flex-col lg:flex-row items-center gap-6">
                                <a href="${ev.wa}" target="_blank" rel="noopener" class="cta-button w-full lg:w-auto">Prenota il tuo posto</a>
                                <span class="text-xs font-bold text-gray-400 uppercase tracking-widest">Posti Limitati</span>
                            </div>
                        </div>
                    </div>`;

                // ARCHIVIO
                const fb = document.getElementById('filter-bar');
                const fl = {all:'Tutti',famiglie:'Famiglie',tradizioni:'Tradizioni',spettacoli:'Spettacoli'};
                ['all','famiglie','tradizioni','spettacoli'].forEach(f => { fb.innerHTML += `<button onclick="renderArchive('${f}')" class="filter-btn ${f==='all'?'active':''}" id="btn-${f}">${fl[f]}</button>`; });
                renderArchive('all');

                // FOOTER
                document.getElementById('strategic-quote').innerHTML = D.footer.quote;
                document.getElementById('contact-methods').innerHTML = `<a href="mailto:${D.footer.email}" class="flex items-center gap-3 hover:text-crea-honey transition-colors text-gray-400"><i data-lucide="mail" class="w-5 h-5"></i> ${D.footer.email}</a>`;
                const sb = document.getElementById('social-links');
                D.footer.socials.forEach(s => { sb.innerHTML += `<a href="${s.url}" target="_blank" rel="noopener" aria-label="${s.icon}" class="w-14 h-14 bg-white/10 rounded-full flex items-center justify-center hover:bg-crea-honey transition-colors text-white">${SOCIAL_ICONS[s.icon]||''}</a>`; });

                // LOGO
                if (D.settings?.logo) {
                    const img=new Image(); img.src=D.settings.logo; img.className='logo-img'; img.alt='Logo CREA 20072';
                    img.onload=()=>{ document.getElementById('nav-logo-container').replaceChildren(img); document.getElementById('footer-logo-container').replaceChildren(img.cloneNode()); };
                }
                lucide.createIcons();
            })
            .catch(() => {
                document.body.innerHTML='<div style="padding:4rem;text-align:center;font-family:monospace"><h1>‚ö†Ô∏è File dati non trovato</h1><p>Assicurati che <strong>data/content.json</strong> esista e che il sito sia servito da un server locale (non aperto come file diretto).</p></div>';
            });
    </script>
</body>
</html>
